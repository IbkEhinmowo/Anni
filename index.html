<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Our Story - Anniversary</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Countdown Only Section (shown until July 23rd) -->
    <section id="countdown-only" class="countdown-only-section">
      <div class="countdown-only-content">
        <!-- Happy Cat GIF above the timer -->
        <div
          class="cat-container"
          style="text-align: center; margin-bottom: 20px"
        >
          <img
            src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDl2dWRudWZ1eGRmb2h3Z2JwZmE2Mzk1c2h6eWJheDE4b3AwcTdrZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/1FkCqpyObTuo0/giphy.gif"
            alt="Happy Cat"
            style="
              width: 120px;
              height: 120px;
              border-radius: 50%;
              box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            "
          />
        </div>

        <h1 class="countdown-only-title">Our Special Day is Coming</h1>
        <div class="countdown-only-timer">
          <div class="countdown-display">
            <div class="countdown-item">
              <span id="days-counter-only">0</span>
              <span class="countdown-unit">days</span>
            </div>
            <div class="countdown-item">
              <span id="hours-counter-only">0</span>
              <span class="countdown-unit">hours</span>
            </div>
            <div class="countdown-item">
              <span id="minutes-counter-only">0</span>
              <span class="countdown-unit">minutes</span>
            </div>
            <div class="countdown-item">
              <span id="seconds-counter-only">0</span>
              <span class="countdown-unit">seconds</span>
            </div>
          </div>
          <p class="countdown-only-subtitle">Until July 23rd, 2025</p>
        </div>
        <div class="countdown-only-hearts">
          <span>ðŸ’•</span>
        </div>
      </div>
    </section>

    <!-- Main Website Content (hidden until July 23rd) -->
    <div id="main-content" class="main-content-hidden">
      <!-- Hero Section -->
      <section class="hero">
        <div class="hero-content">
          <!-- Happy Cat GIF above the countdown -->
          <div
            class="cat-container"
            style="text-align: center; margin-bottom: 20px"
          >
            <img
              src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDl2dWRudWZ1eGRmb2h3Z2JwZmE2Mzk1c2h6eWJheDE4b3AwcTdrZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/1FkCqpyObTuo0/giphy.gif"
              alt="Happy Cat"
              style="
                width: 120px;
                height: 120px;
                border-radius: 50%;
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
              "
            />
          </div>

          <div class="hero-countdown">
            <div class="countdown-display">
              <div class="countdown-item">
                <span id="days-counter">0</span>
                <span class="countdown-unit">days</span>
              </div>
              <div class="countdown-item">
                <span id="hours-counter">0</span>
                <span class="countdown-unit">hours</span>
              </div>
              <div class="countdown-item">
                <span id="minutes-counter">0</span>
                <span class="countdown-unit">minutes</span>
              </div>
              <div class="countdown-item">
                <span id="seconds-counter">0</span>
                <span class="countdown-unit">seconds</span>
              </div>
            </div>
            <span class="counter-label">until our Next special day</span>
          </div>

          <h1 class="hero-title">
            <span class="hero-line">Two Hearts,</span>
            <span class="hero-line">One Story</span>
          </h1>
          <p class="hero-subtitle">Happy Anniversary</p>
          <div class="hero-date">
            <div class="date-line"></div>
            <span>Since July 23rd 2024</span>
            <div class="date-line"></div>
          </div>
        </div>
        <div class="hero-scroll">
          <div class="scroll-indicator"></div>
        </div>
      </section>

      <!-- Slideshow Gallery Section -->
      <section id="gallery" class="gallery">
        <div class="container">
          <div class="section-header">
            <h2>Our Time Well Spent</h2>
            <p>A curated collection of memories</p>
          </div>

          <!-- Slideshow Container -->
          <div class="slideshow-container">
            <div class="slideshow-wrapper">
              <img id="slideshow-image" src="" alt="Our memories" />
              <div class="image-overlay">
                <div class="image-info">
                  <span class="image-counter" id="image-counter">1 / 1</span>
                  <span class="image-title" id="image-title">Loading...</span>
                </div>
              </div>
            </div>

            <!-- Navigation Controls -->
            <div class="slideshow-controls">
              <button class="control-btn prev" id="prev-btn">â€¹</button>
              <button class="control-btn next" id="next-btn">â€º</button>
            </div>

            <!-- Dots Indicator -->
            <div class="slideshow-dots" id="slideshow-dots">
              <!-- Dots will be generated by JavaScript -->
            </div>
          </div>
        </div>
      </section>

      <!-- Timeline Section -->

      <!-- Message Section -->
      <section id="message" class="message">
        <div class="container">
          <div class="message-content">
            <div class="message-quote">"</div>
            <div class="message-text">
              <p>
                Pookie means a lot to me and I'm glad to be called your
                Boyfriend
              </p>
              <p>
                Thank you for being my partner, my best friend, and i hope we
                get to celebrate many more years
              </p>
            </div>
            <div class="message-signature">
              <div class="signature-line"></div>
              <span>Forever yours</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="footer">
        <div class="container">
          <div class="footer-content">
            <div class="footer-text">Made with love</div>
            <div class="footer-year">2025</div>
          </div>
        </div>
      </footer>
    </div>

    <script>
      // DEBUG MODE: Set to true to force show main content, false to force show countdown
      const DEBUG_SHOW_MAIN_CONTENT = false; // Change this to test different views

      // Page visibility and countdown management
      function checkDateAndShowContent() {
        const now = new Date();
        const currentYear = now.getFullYear();

        // Check if today is July 23rd of any year
        const isAnniversaryDay = now.getMonth() === 6 && now.getDate() === 23; // July is month 6 (0-indexed)

        // Calculate next July 23rd
        let nextAnniversary;
        if (isAnniversaryDay) {
          // If it's currently July 23rd, next anniversary is next year
          nextAnniversary = new Date(currentYear + 1, 6, 23, 0, 0, 0);
        } else if (
          now.getMonth() < 6 ||
          (now.getMonth() === 6 && now.getDate() < 23)
        ) {
          // If we haven't reached July 23rd this year yet
          nextAnniversary = new Date(currentYear, 6, 23, 0, 0, 0);
        } else {
          // If July 23rd has passed this year
          nextAnniversary = new Date(currentYear + 1, 6, 23, 0, 0, 0);
        }

        const countdownSection = document.getElementById("countdown-only");
        const mainContent = document.getElementById("main-content");

        // Use debug override if enabled, otherwise check if it's July 23rd
        const shouldShowMainContent =
          DEBUG_SHOW_MAIN_CONTENT || isAnniversaryDay;

        if (shouldShowMainContent) {
          // It's July 23rd OR debug mode - show main content
          countdownSection.style.display = "none";
          mainContent.classList.remove("main-content-hidden");
          mainContent.classList.add("main-content-visible");

          // Initialize slideshow after revealing content (only once)
          setTimeout(() => {
            if (!window.currentSlideshow) {
              console.log("Initializing new slideshow");
              new PhotoSlideshow();
            } else {
              console.log("Slideshow already exists");
            }
          }, 500);

          return { showCountdownOnly: false, nextAnniversary };
        } else {
          // Not July 23rd - show countdown only
          countdownSection.style.display = "flex";
          mainContent.classList.add("main-content-hidden");
          mainContent.classList.remove("main-content-visible");

          return { showCountdownOnly: true, nextAnniversary };
        }
      }

      // Countdown timer for countdown-only view
      function updateCountdownOnly(nextAnniversary) {
        const targetDate = nextAnniversary.getTime();
        const now = new Date().getTime();
        const timeLeft = targetDate - now;

        if (timeLeft > 0) {
          // Calculate time units
          const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
          const hours = Math.floor(
            (timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
          );
          const minutes = Math.floor(
            (timeLeft % (1000 * 60 * 60)) / (1000 * 60)
          );
          const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

          // Update countdown-only display
          document.getElementById("days-counter-only").textContent = days;
          document.getElementById("hours-counter-only").textContent = String(
            hours
          ).padStart(2, "0");
          document.getElementById("minutes-counter-only").textContent = String(
            minutes
          ).padStart(2, "0");
          document.getElementById("seconds-counter-only").textContent = String(
            seconds
          ).padStart(2, "0");

          // Update subtitle with the correct year
          const subtitle = document.querySelector(".countdown-only-subtitle");
          if (subtitle) {
            subtitle.textContent = `Until July 23rd, ${nextAnniversary.getFullYear()}`;
          }
        }
      }

      // Detailed countdown for main hero section
      function updateDetailedCounter(nextAnniversary) {
        const targetDate = nextAnniversary.getTime();
        const now = new Date().getTime();
        const timeLeft = targetDate - now;

        if (timeLeft > 0) {
          // Calculate time units
          const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
          const hours = Math.floor(
            (timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
          );
          const minutes = Math.floor(
            (timeLeft % (1000 * 60 * 60)) / (1000 * 60)
          );
          const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

          // Update the display (only if elements exist)
          const daysEl = document.getElementById("days-counter");
          const hoursEl = document.getElementById("hours-counter");
          const minutesEl = document.getElementById("minutes-counter");
          const secondsEl = document.getElementById("seconds-counter");

          if (daysEl) daysEl.textContent = days;
          if (hoursEl) hoursEl.textContent = String(hours).padStart(2, "0");
          if (minutesEl)
            minutesEl.textContent = String(minutes).padStart(2, "0");
          if (secondsEl)
            secondsEl.textContent = String(seconds).padStart(2, "0");
        } else {
          // This shouldn't happen on July 23rd, but just in case
          const daysEl = document.getElementById("days-counter");
          const hoursEl = document.getElementById("hours-counter");
          const minutesEl = document.getElementById("minutes-counter");
          const secondsEl = document.getElementById("seconds-counter");
          const labelEl = document.querySelector(".counter-label");

          if (daysEl) daysEl.textContent = "0";
          if (hoursEl) hoursEl.textContent = "00";
          if (minutesEl) minutesEl.textContent = "00";
          if (secondsEl) secondsEl.textContent = "00";
          if (labelEl) labelEl.textContent = "Happy Anniversary! ðŸŽ‰";
        }
      }

      // Initialize on page load
      document.addEventListener("DOMContentLoaded", () => {
        // Check initial state
        const result = checkDateAndShowContent();

        if (result.showCountdownOnly) {
          // Start countdown-only timer
          updateCountdownOnly(result.nextAnniversary);
          setInterval(() => {
            const newResult = checkDateAndShowContent(); // Check if we should switch views
            if (newResult.showCountdownOnly) {
              updateCountdownOnly(newResult.nextAnniversary);
            }
          }, 1000);
        } else {
          // It's July 23rd, show main content with countdown to next year
          updateDetailedCounter(result.nextAnniversary);
          setInterval(() => {
            const newResult = checkDateAndShowContent(); // Check if we should switch views
            if (!newResult.showCountdownOnly) {
              updateDetailedCounter(newResult.nextAnniversary);
            }
          }, 1000);
        }
      });

      // Slideshow functionality
      class PhotoSlideshow {
        constructor() {
          // Prevent multiple instances
          if (window.currentSlideshow) {
            console.log(
              "Slideshow already exists, returning existing instance"
            );
            return window.currentSlideshow;
          }

          this.photos = [];
          this.currentIndex = 0;
          this.keyboardListenerAdded = false;
          window.currentSlideshow = this;
          this.init();
        }

        async init() {
          await this.loadPhotos();
          this.setupEventListeners();
          if (this.photos.length > 0) {
            this.showImage(0);
            this.createDots();
          }
        }

        async loadPhotos() {
          // Your actual image files with correct extensions
          const imageFiles = [
            "1.jpeg",
            "2.jpeg",
            "3.JPG",
            "4.jpeg",
            "5.JPG",
            "6.jpeg",
            "7.jpeg",
            "8.jpeg",
            "9.jpeg",
            "10.jpg",
            "11.jpg",
          ];

          // Load all images directly - they should exist
          imageFiles.forEach((filename, index) => {
            const imagePath = `photos/${filename}`;
            const imageNumber = filename.match(/\d+/)[0];
            this.photos.push({
              src: imagePath,
              title: `Memory ${imageNumber}`,
              alt: `Photo ${imageNumber}`,
            });
          });

          console.log(`Loaded ${this.photos.length} photos:`, this.photos);

          // Fallback if no images found
          if (this.photos.length === 0) {
            this.photos = [
              {
                src: "https://via.placeholder.com/800x600/f88c9e/ffffff?text=Add+Photos+to+/photos+folder",
                title: "Add your photos to the /photos folder",
                alt: "Placeholder",
              },
            ];
          }
        }

        imageExists(src) {
          return new Promise((resolve) => {
            const img = new Image();
            img.onload = () => resolve(true);
            img.onerror = () => resolve(false);
            img.src = src;
          });
        }

        setupEventListeners() {
          const prevBtn = document.getElementById("prev-btn");
          const nextBtn = document.getElementById("next-btn");

          // Remove any existing event listeners first
          prevBtn.replaceWith(prevBtn.cloneNode(true));
          nextBtn.replaceWith(nextBtn.cloneNode(true));

          // Get the new elements after cloning
          const newPrevBtn = document.getElementById("prev-btn");
          const newNextBtn = document.getElementById("next-btn");

          newPrevBtn.addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();
            this.previousImage();
          });

          newNextBtn.addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();
            this.nextImage();
          });

          // Keyboard navigation - only add once
          if (!this.keyboardListenerAdded) {
            document.addEventListener("keydown", (e) => {
              if (e.key === "ArrowLeft") {
                e.preventDefault();
                this.previousImage();
              }
              if (e.key === "ArrowRight") {
                e.preventDefault();
                this.nextImage();
              }
            });
            this.keyboardListenerAdded = true;
          }

          // Remove click to advance feature as it might be causing conflicts
          // const slideImage = document.getElementById("slideshow-image");
          // slideImage.addEventListener("click", () => this.nextImage());
        }

        showImage(index) {
          if (this.photos.length === 0) return;

          console.log(
            `Showing image ${index} of ${this.photos.length} total photos`
          );
          console.log(`Current photo:`, this.photos[index]);

          this.currentIndex = index;
          const photo = this.photos[index];

          const imageEl = document.getElementById("slideshow-image");
          const counterEl = document.getElementById("image-counter");
          const titleEl = document.getElementById("image-title");

          imageEl.src = photo.src;
          imageEl.alt = photo.alt;
          counterEl.textContent = `${index + 1} / ${this.photos.length}`;
          titleEl.textContent = photo.title;

          this.updateDots();
        }

        nextImage() {
          console.log(
            `Next image clicked. Current index: ${this.currentIndex}, Total photos: ${this.photos.length}`
          );
          const nextIndex = (this.currentIndex + 1) % this.photos.length;
          console.log(`Moving to index: ${nextIndex}`);
          this.showImage(nextIndex);
        }

        previousImage() {
          console.log(
            `Previous image clicked. Current index: ${this.currentIndex}, Total photos: ${this.photos.length}`
          );
          const prevIndex =
            (this.currentIndex - 1 + this.photos.length) % this.photos.length;
          console.log(`Moving to index: ${prevIndex}`);
          this.showImage(prevIndex);
        }

        createDots() {
          const dotsContainer = document.getElementById("slideshow-dots");
          dotsContainer.innerHTML = "";

          this.photos.forEach((_, index) => {
            const dot = document.createElement("span");
            dot.className = "dot";
            dot.addEventListener("click", () => this.showImage(index));
            dotsContainer.appendChild(dot);
          });
        }

        updateDots() {
          const dots = document.querySelectorAll(".dot");
          dots.forEach((dot, index) => {
            dot.classList.toggle("active", index === this.currentIndex);
          });
        }
      }

      // Initialize slideshow when page loads
      // Note: This is now called conditionally from checkDateAndShowContent()
    </script>
  </body>
</html>
